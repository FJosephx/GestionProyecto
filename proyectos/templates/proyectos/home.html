{% extends 'proyectos/base.html' %}

{% block title %}Inicio - Gesti√≥n TI{% endblock %}

{% block content %}
<h1 class="mb-4">Proyectos TI</h1>

<form method="get" id="filtroForm" class="mb-4">
    <div class="input-group">
        <input type="text" name="q" class="form-control" placeholder="Buscar proyectos..." value="{{ request.GET.q }}">
        <button type="submit" class="btn btn-outline-primary">Buscar</button>
    </div>
</form>

<a href="{% url 'proyecto_create' %}" class="btn btn-success mb-4">+ Nuevo Proyecto</a>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-primary shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Proyectos Activos</h5>
                <p class="card-text display-6">{{ proyectos_activos }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-success shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Proyectos Finalizados</h5>
                <p class="card-text display-6">{{ proyectos_finalizados }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-info shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Tareas Totales</h5>
                <p class="card-text display-6">{{ tareas_totales }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Tareas Completadas</h5>
                <p class="card-text display-6">{{ tareas_completadas }}</p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-body text-center">
                <h5 class="card-title">Tareas Completadas vs Pendientes</h5>
                <div class="chart-container">
                    <canvas id="tareasChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-body text-center">
                <h5 class="card-title">Proyectos Activos vs Finalizados</h5>
                <div class="chart-container">
                    <canvas id="proyectosChart"></canvas>
                </div>
            </div>            
        </div>
    </div>
</div>

<script>
    window.chartDataTareas = [{{ tareas_completadas }}, {{ tareas_pendientes }}];
    window.chartDataProyectos = [{{ proyectos_activos }}, {{ proyectos_finalizados }}];
</script>
    

<div class="row mb-4">
    <div class="col-md-12">
        <div class="card text-dark bg-light shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Avance Promedio General</h5>
                <p id="avancePromedioGeneral"  class="card-text display-6">{{ avance_promedio }}%</p>
            </div>
        </div>
    </div>
</div>

<div id="proyectosContainer">
    {% include 'proyectos/proyectos_list.html' %}
</div>



{% endblock %}
